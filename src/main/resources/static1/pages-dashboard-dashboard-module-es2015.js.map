{"version":3,"sources":["./src/app/pages/dashboard/dashboard.module.ts","./src/app/pages/dashboard/dashboard.page.ts","./src/app/pages/dashboard/dashboard.page.html","./src/app/pages/main/report-history.service.ts","./src/app/pages/dashboard/dashboard-routing.module.ts","./src/app/common/generate-report.guard.ts"],"names":[],"mappings":"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","file":"pages-dashboard-dashboard-module-es2015.js","sourcesContent":["import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\n\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { DashboardRoutingModule } from './dashboard-routing.module';\r\nimport { DashboardPage } from './dashboard.page';\r\nimport {MatIconModule} from '@angular/material/icon';\r\n\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [DashboardPage],\r\n  imports: [\r\n    CommonModule,\r\n    DashboardRoutingModule,\r\n    FormsModule,\r\n    MatIconModule,\r\n\r\n\r\n  ]\r\n})\r\nexport class DashboardModule { }\r\n","import { AfterViewInit, Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { switchMap, take } from 'rxjs/operators';\r\nimport { AuthService } from 'src/app/common/auth.service';\r\nimport { ReportService } from '../generate-report/report.service';\r\nimport swa from 'sweetalert';\r\nimport { ReportHistoryService } from '../main/report-history.service';\r\n\r\n@Component({\r\n  selector: 'app-dashboard',\r\n  templateUrl:'./dashboard.page.html',\r\n  styleUrls: ['./dashboard.page.css']\r\n})\r\nexport class DashboardPage implements OnInit, OnDestroy, AfterViewInit {\r\n\r\n  selectedDate: string = null;\r\n  $dateSubscription: Subscription;\r\n\r\n  constructor(\r\n    private readonly authService: AuthService,\r\n    private readonly reportService: ReportService,\r\n    private readonly reportHistory: ReportHistoryService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.$dateSubscription = this.reportService.selectedDate.subscribe(date => {\r\n     this.selectedDate = date;\r\n    })\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n\r\n  }\r\n\r\n  logout() {\r\n    this.authService.logout()\r\n  }\r\n\r\n  // storeDate() {\r\n  //   if(this.selectedDate !== null && this.selectedDate.length !== 0) {\r\n  //     console.log(this.selectedDate)\r\n  //     // this.reportService.saveReportDate().subscribe(_ => {}, err => {\r\n  //         // swa({\r\n  //         //   title: 'Couldn\\'t set date',\r\n  //         //   text: `An error occurred while setting date`,\r\n  //         //   icon: 'error',\r\n  //         // });\r\n  //     this.reportHistory.postReportDate(this.selectedDate);\r\n\r\n  //   }\r\n  // }\r\n\r\n  ngOnDestroy() {\r\n    if(this.$dateSubscription) {\r\n      this.$dateSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n}\r\n","\r\n<div class=\"topnav\" id=\"myTopnav\">\r\n  <!-- <a class=\"navbar-brand\" routerLink=\"/dashboard\"><img src=\"https://i0.wp.com/neptunesoftwaregroup.com/wp-content/uploads/2021/06/logos2.png?resize=300%2C97&ssl=1\" /></a> -->\r\n  <!-- <a class=\"navbar-brand\" routerLink=\"/dashboard\"><img src=\"../../../assets/img/Neptune2.png\" /></a> -->\r\n  <a class=\"navbar-brand\" routerLink=\"/dashboard\"><img src=\"../../../assets/img/efass-dashboard-logo.png\" /></a>\r\n\r\n\r\n  <div class=\"navbar-brand\">\r\n      <!-- <img src=\"https://i0.wp.com/neptunesoftwaregroup.com/wp-content/uploads/2021/06/logos2.png?resize=300%2C97&ssl=1\" /> -->\r\n      <span class=\"h4 text-white\">Electronic Financial Analysis and Surveillance System (Efass)</span>\r\n      <!-- <img src=\"./assets/img/Neptune_logo.png\" alt=\"\"/> -->\r\n  </div>\r\n  <b><a class=\"logout\" (click)=\"logout()\">LOGOUT</a></b>\r\n</div>\r\n\r\n<!-- The sidebar -->\r\n<div class=\"sidebar\">\r\n  <br>\r\n  <br>\r\n  <a routerLinkActive=\"active\" routerLink=\"/dashboard\" [routerLinkActiveOptions]=\"{exact:true}\"><mat-icon>home</mat-icon> Dashboard</a>\r\n  <a [class.disabled]=\"selectedDate === null || selectedDate.length === 0\" routerLinkActive=\"active\" routerLink=\"generate_report/data/assets\"><mat-icon>folder</mat-icon> Generate Report</a>\r\n  <a routerLinkActive=\"active\" routerLink=\"user_settings\"><mat-icon>settings</mat-icon> Settings</a>\r\n  </div>\r\n<!-- Page content -->\r\n<div class=\"main\">\r\n  <router-outlet></router-outlet>\r\n</div>\r\n","import { Injectable } from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {environment} from '../../../environments/environment';\nimport {Observable} from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ReportHistoryService {\n\n  constructor(private http: HttpClient) { }\n\n  getReportHistory(): Observable<any> {\n    return this.http.get<any>(`${environment.baseApi}/` + 'activities');\n  }\n\n  postReportDate(date: any): Observable<any> {\n    return  this.http.post(`${environment.baseApi}/` + 'date', date, {responseType: 'text'});\n   }\n\n\n\n   postCbnDate(date: any): Observable<any> {\n    return  this.http.post(`${environment.baseApi}/` + 'cbnDate', date, {responseType: 'text'});\n   }\n\n\n\n  // tslint:disable-next-line:typedef\n  deleteReportHistory(id: any) {\n    return this.http.delete<any>(`${environment.baseApi}/` + 'activity/' + id);\n  }\n}\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { AuthenticatedGuard } from 'src/app/common/authenticated.guard';\r\nimport { GenerateReportGuard } from 'src/app/common/generate-report.guard';\r\nimport { DashboardPage } from './dashboard.page';\r\n\r\n\r\nconst routes: Routes = [\r\n\r\n  {\r\n    path: '', component: DashboardPage,\r\n    canActivate: [AuthenticatedGuard], canActivateChild: [AuthenticatedGuard],\r\n    children: [\r\n      {path: 'user_settings', loadChildren: () => import('../user-settings/user-settings.module').then( m => m.UserSettingsModule)},\r\n      {path: 'generate_report', loadChildren: () => import('../generate-report/generate-report.module').then( m => m.GenerateReportModule), canActivate: [GenerateReportGuard], canActivateChild: [GenerateReportGuard]},\r\n      {path: 'doc/:id', loadChildren: () => import('../xml-viewer/xml-viewer.module').then( m => m.XmlViewerModule)},\r\n      {path: '', loadChildren: () => import('../main/main.module').then( m => m.MainModule),  pathMatch: 'full'},\r\n      // {\r\n      //   path: '',\r\n      //   redirectTo: '/dashboard/generate_report',\r\n      //   pathMatch: 'full'\r\n      // }\r\n    ],\r\n  },\r\n  // {\r\n  //   path: '',\r\n  //   redirectTo: '/dashboard/generate_report',\r\n  //   pathMatch: 'full'\r\n  // }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class DashboardRoutingModule { }\r\n","import { Location } from '@angular/common';\r\nimport { Injectable } from '@angular/core';\r\nimport { CanActivate, CanActivateChild, CanLoad, Route, UrlSegment, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, Router } from '@angular/router';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { ReportService } from '../pages/generate-report/report.service';\r\nimport { AuthService } from './auth.service';\r\n\r\n/**\r\n * this guard route that shouldn't be accessed date is not selected\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GenerateReportGuard implements CanActivate, CanActivateChild, CanLoad {\r\n\r\n  constructor(\r\n    private readonly router: Router,\r\n    private reportService: ReportService,\r\n    private readonly location: Location\r\n  ) {}\r\n\r\n  canActivate(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n      return this.reportService.selectedDate.pipe(map(date => {\r\n        // const navigationId\r\n        const navigationId = (this.location.getState() as any)?.navigationId;\r\n        if(date !== null && date.length > 0) {\r\n          return true;\r\n        } else if( navigationId === null || navigationId === undefined  || navigationId <= 1) {\r\n          this.router.navigate(['/'])\r\n        }\r\n        return false;\r\n      }))\r\n  }\r\n  canActivateChild(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n      return this.canActivate(next, state);\r\n  }\r\n  canLoad(\r\n    route: Route,\r\n    segments: UrlSegment[]): Observable<boolean> | Promise<boolean> | boolean {\r\n      return this.reportService.selectedDate.pipe(map(date => {\r\n        if(date !== null || date.length > 0) {\r\n          return true;\r\n        }\r\n        return false;\r\n      }))\r\n  }\r\n}"],"sourceRoot":"webpack:///"}